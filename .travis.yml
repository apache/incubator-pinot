language: java
os:
  - linux
dist: trusty

before_install:
  - mkdir -p ~/bin && curl -sSL -o ~/bin/jq https://github.com/stedolan/jq/releases/download/jq-1.5/jq-linux64 && chmod +x ~/bin/jq
  - export PATH=$PATH:~/bin
  - jq --version
  - curl -sSL -o ~/bin/install-jdk.sh https://raw.githubusercontent.com/sormuras/bach/master/install-jdk.sh && chmod +x ~/bin/install-jdk.sh

cache:
  directories:
    - $HOME/.m2
  yarn: true

addons:
  firefox: latest

install:
  - ./.travis_install.sh

branches:
  only:
    - master

jobs:
  include:
    - name: "Integration Tests - OracleJDK 8"
      jdk: oraclejdk8
      script:
        - ./.travis_test.sh
      env:
        - RUN_INTEGRATION_TESTS=true
    - name: "Unit Tests - OracleJDK 8"
      jdk: oraclejdk8
      script:
        - ./.travis_test.sh
      env:
        - RUN_INTEGRATION_TESTS=false
    - name: "QuickStart - Java 8"
      jdk: oraclejdk8
      script:
        - ./.travis_quickstart.sh
        - jdk_switcher use openjdk8
        - ./.travis_install.sh
        - ./.travis_quickstart.sh
    - name: "QuickStart - Java 11"
      jdk: oraclejdk11
      script:
        - ./.travis_quickstart.sh
        - export JAVA_HOME=$HOME/openjdk11
        - ~/bin/install-jdk.sh --target $JAVA_HOME --feature "11" --license "GPL" --cacerts
        - ./.travis_install.sh
        - ./.travis_quickstart.sh
